@page "/pvs"

@using Braveior.KubeAssist.Services
@using Braveior.KubeAssist.Services.Models
@inject KubernetesService KubernetesService

<MudTable Dense="true"  Items="@PVList" Hover="true" Breakpoint="Breakpoint.Sm">
    <HeaderContent>
        <MudTh>Name</MudTh>
        <MudTh>Storage Class</MudTh>
        <MudTh>Phase</MudTh>
        <MudTh>Capacity</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Name">@context.Metadata.Name</MudTd>
        <MudTd DataLabel="StorageClass">@context.Spec.StorageClassName</MudTd>
        <MudTd DataLabel="Phase">@context.Status.Phase</MudTd>
        <MudTd DataLabel="Capacity">@context.Spec.Capacity["storage"]</MudTd>
    </RowTemplate>
 </MudTable>


@code
{


    protected override void OnInitialized()
    {
        LoadPersistenceVolumes();
        base.OnInitialized();
    }

    private async Task LoadPersistenceVolumes()
    {
        var pvs = await KubernetesService.GetPersistentVolumes("default");
        if (pvs.Items != null)
        {
            PVList = pvs.Items.ToList();
        }
        StateHasChanged();
        //if (KubeStateState.Value.KubeState != null)
        //{
        //    PVList = KubeStateState.Value.KubeState.PersistentVolumes;
        //}
    }
    private static List<V1PersistentVolume> PVList { get; set; }


}
